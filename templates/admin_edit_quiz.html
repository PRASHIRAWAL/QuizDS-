{% extends "base.html" %}
{% block content %}
<div class="quiz-builder card">
    <h1 class="page-title">Edit Quiz</h1>
    <div class="form-group">
        <label for="quiz-title">Quiz Title</label>
        <input type="text" id="quiz-title" value="{{ quiz.title }}">
    </div>
    <div class="form-group">
        <label for="quiz-description">Quiz Description</label>
        <textarea id="quiz-description" rows="3">{{ quiz.description }}</textarea>
    </div>
    <hr>
    <div id="questions-container">
        </div>
    <button id="add-question-btn" class="btn btn-secondary">Add Question</button>
    <hr>
    <button id="save-quiz-btn" class="btn btn-success">Update Quiz</button>
</div>

<script type="application/json" id="quiz-data">
    {
        "title": "{{ quiz.title }}",
        "description": "{{ quiz.description }}",
        "questions": [
            {% for question in quiz.questions %}
            {
                "text": "{{ question.text | tojson }}",
                "options": [
                    {% for option in question.options %}
                    {
                        "text": "{{ option.text | tojson }}",
                        "is_correct": {{ 'true' if option.is_correct else 'false' }}
                    }
                    {{ "," if not loop.last }}
                    {% endfor %}
                ]
            }
            {{ "," if not loop.last }}
            {% endfor %}
        ]
    }
</script>

<script src="{{ url_for('static', filename='js/quizBuilder.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const quizData = JSON.parse(document.getElementById('quiz-data').textContent);
        initializeQuizBuilder('edit', quizData, "{{ quiz.id | tojson }}");
    });
</script>
{% endblock %}